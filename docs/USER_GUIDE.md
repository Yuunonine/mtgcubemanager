# MTG Cubes ユーザーマニュアル

MTGキューブ管理システムの詳細な使用方法を説明します。

## 目次

1. [はじめに](#はじめに)
2. [基本操作](#基本操作)
3. [キューブ管理](#キューブ管理)
4. [カード検索と追加](#カード検索と追加)
5. [セット別画像選択](#セット別画像選択)
6. [キューブ分析](#キューブ分析)
7. [言語設定](#言語設定)
8. [表示モード](#表示モード)
9. [よくある質問](#よくある質問)
10. [トラブルシューティング](#トラブルシューティング)

## はじめに

MTG Cubesは、Magic: The Gatheringのキューブ構築を支援するWebアプリケーションです。カードの検索・追加から詳細な分析まで、キューブ構築に必要な機能を提供します。

### 主要な特徴

- **直感的なUI**: 使いやすいマテリアルデザイン
- **高速検索**: Scryfall APIを使用した包括的なカード検索
- **セット選択**: 同じカードでも好みのセット版を選択可能
- **詳細分析**: カラーバランス、マナカーブ、統計情報
- **多言語対応**: 日本語・英語の切り替え
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

## 基本操作

### アプリケーションの起動

```bash
# Dockerを使用する場合
cd docker
./run.sh up         # Linux/Mac
.\run.ps1 up        # Windows PowerShell
run.bat up          # Windows Command Prompt

# ローカル開発環境の場合
npm run dev
```

ブラウザで `http://localhost:3001` （Docker）または `http://localhost:3000` （ローカル開発）にアクセスします。

### メイン画面の構成

1. **ヘッダー**
   - アプリケーションタイトル
   - 言語切り替えボタン（🌐）

2. **ナビゲーション**
   - キューブ一覧タブ
   - 個別キューブタブ（キューブ選択時）

3. **メインコンテンツ**
   - キューブ一覧または詳細表示
   - カード検索・追加エリア
   - 分析表示エリア

## キューブ管理

### 新しいキューブの作成

1. メイン画面の「新しいキューブを作成」ボタンをクリック
2. キューブ名を入力
3. 説明（オプション）を入力
4. 「作成」ボタンをクリック

```
例:
名前: 「Modern Cube 2024」
説明: 「モダンフォーマットの人気カードを集めたキューブ」
```

### キューブの編集

- キューブ一覧でキューブをクリックして選択
- キューブ詳細画面で編集・管理を行う

### キューブの削除

⚠️ **注意**: 削除は取り消せません。

1. キューブ一覧で削除したいキューブを選択
2. 削除ボタン（🗑️）をクリック
3. 確認ダイアログで「削除」を選択

## カード検索と追加

### 基本的なカード検索

1. キューブ詳細画面の「カード検索」タブを選択
2. 検索ボックスにカード名を入力
3. 検索ボタンをクリックまたはEnterキーを押す

#### 検索のコツ

- **日本語検索**: 「稲妻」「黒蓮の花弁」など
- **英語検索**: 「Lightning Bolt」「Black Lotus」など  
- **部分一致**: 「稲妻」で「稲妻」「連鎖稲妻」などがヒット
- **マナコスト検索**: 「cmc:3」で マナコスト3のカードを検索
- **色指定検索**: 「c:red」で赤のカードを検索

### 詳細検索オプション

Scryfallの検索構文が使用できます：

```
例:
t:creature cmc:3               # マナコスト3のクリーチャー
c:white c:blue                 # 白青のカード
pow:3 tou:3                    # パワー・タフネス3/3
rarity:mythic                  # 神話レア
set:thb                        # テーロス還魂記のカード
```

### カードの追加

#### 通常の追加

1. 検索結果からカードを選択
2. 「追加」ボタンをクリック
3. カードがキューブに追加される

#### セット選択付きの追加

1. 検索結果で歯車アイコン（⚙️）をクリック
2. セット選択ダイアログで希望するセット版を選択
3. 選択したセット版でキューブに追加される

### ページング

- 検索結果が多い場合は自動的にページング
- ページサイズ変更（12/18/24/36件）が可能
- ページ番号クリックで移動

## セット別画像選択

同じカードでも異なるセット（版）の画像を選択できます。

### 使用方法

1. **検索時に選択**
   - カード検索結果で歯車アイコン（⚙️）をクリック
   - セット選択ダイアログが開く
   - 希望するセット版をクリックして選択

2. **選択可能な情報**
   - セット名
   - セットコード
   - コレクター番号
   - 発売日
   - レアリティ
   - カード画像

3. **選択後の動作**
   - 選択したセット版の画像でキューブに追加
   - キューブ内での表示も選択したセット版を使用

### セット選択の例

「稲妻」カードの場合：
- Alpha版の稲妻
- Beta版の稲妻  
- Unlimited版の稲妻
- 各種セット再録版

好みの時代やアートワークの版を選択できます。

## キューブ分析

キューブの構成を詳細に分析できます。

### 分析タブの表示

キューブ詳細画面で「分析」タブを選択すると以下の情報が表示されます：

### 1. 基本統計

- **総カード数**: キューブ内の総カード枚数
- **平均マナコスト**: 全カードの平均マナコスト
- **カードタイプ分布**: クリーチャー、呪文、土地の割合

### 2. カラーバランス分析

円グラフで各色の分布を表示：
- **白** (W): 白のカード数と割合
- **青** (U): 青のカード数と割合
- **黒** (B): 黒のカード数と割合
- **赤** (R): 赤のカード数と割合
- **緑** (G): 緑のカード数と割合
- **多色**: 2色以上のカード
- **無色**: アーティファクト、土地など

### 3. マナカーブ分析

棒グラフでマナコストごとのカード分布を表示：
- 横軸: マナコスト（0, 1, 2, 3, 4, 5, 6, 7+）
- 縦軸: カード数
- 理想的なマナカーブの確認が可能

### 4. カードタイプ分布

カードタイプごとの内訳：
- **クリーチャー**: 生物カード
- **インスタント**: 瞬間魔法
- **ソーサリー**: 魔法
- **エンチャント**: エンチャント
- **アーティファクト**: アーティファクト
- **プレインズウォーカー**: プレインズウォーカー
- **土地**: 土地カード

### 5. レアリティ分布

希少度ごとの構成：
- **コモン**: よくあるカード
- **アンコモン**: あまりないカード
- **レア**: 珍しいカード
- **神話レア**: 非常に珍しいカード

### 分析の活用方法

1. **バランス調整**
   - 色の偏りをチェック
   - マナカーブの調整
   - カードタイプの比率確認

2. **ドラフト性能**
   - 各色が平等にドラフトできるか
   - アーキタイプごとの支援カード数

3. **パワーレベル**
   - レアリティ分布の確認
   - 強力なカードの偏りチェック

## 言語設定

アプリケーションは日本語と英語に対応しています。

### 言語の切り替え

1. 画面右上の地球アイコン（🌐）をクリック
2. 日本語（JP）または英語（EN）を選択
3. UIとカード情報が選択した言語に切り替わる

### 言語別の表示内容

#### 日本語モード
- UIのすべてのテキストが日本語
- カード名が日本語（利用可能な場合）
- カードタイプラインが日本語
- カードテキストが日本語（翻訳）
- レアリティ名が日本語

#### 英語モード
- UIのすべてのテキストが英語
- カード名が英語（オリジナル）
- カードタイプラインが英語
- カードテキストが英語（オリジナル）
- レアリティ名が英語

### 検索言語

- 日本語モードでも英語での検索が可能
- 英語モードでも日本語での検索が可能
- 自動的に最適な結果を表示

## 表示モード

キューブ内のカード表示方法を選択できます。

### グリッド表示

- **特徴**: カード画像を中心とした表示
- **適用場面**: カードの見た目を重視したい場合
- **情報**: カード画像、名前、マナコスト、タイプライン
- **操作**: カードクリックで詳細表示

### リスト表示

- **特徴**: テーブル形式の一覧表示
- **適用場面**: 多くのカード情報を一度に確認したい場合
- **情報**: 画像、名前、マナコスト、タイプ、レアリティ、セット
- **操作**: ソート機能、詳細な情報表示

### 表示モードの切り替え

キューブ詳細画面の右上にある切り替えボタンを使用：
- グリッドアイコン（⋮⋮⋮）: グリッド表示
- リストアイコン（☰）: リスト表示

## よくある質問

### Q1: カードが検索で見つからない

**A**: 以下を確認してください：
- カード名のスペルが正しいか
- 日本語名と英語名の両方で試す
- 部分一致で検索する（「稲妻」→「Lightning」）
- Scryfallに登録されていないカードは検索できません

### Q2: 画像が表示されない

**A**: 以下の原因が考えられます：
- インターネット接続の問題
- Scryfallサーバーの一時的な問題
- ブラウザの画像読み込み設定
- アドブロッカーの干渉

### Q3: セット選択で古いセットが出ない

**A**: Scryfallデータベースの収録状況に依存します：
- 比較的新しいセットほど情報が充実
- 古いセットは情報が限定的な場合がある
- プロモーションカードなど特殊な版は見つからない場合がある

### Q4: 分析結果がおかしい

**A**: 以下を確認してください：
- ハイブリッドマナのカードは多色としてカウント
- 土地カードは無色としてカウント
- 両面カードは表面の情報で分析
- データの更新にはページリロードが必要な場合がある

### Q5: データの保存場所

**A**: データの保存場所：
- **Docker環境**: 永続化ボリューム `mtgcubes-data`
- **ローカル環境**: `server/data/cubes.db`
- 定期的なバックアップを推奨

### Q6: 他の人とキューブを共有したい

**A**: 現在の版では共有機能は未実装です：
- ローカル環境での使用のみ
- エクスポート・インポート機能は将来の実装予定
- データベースファイルの直接コピーは可能

## トラブルシューティング

### アプリケーションが起動しない

1. **Docker環境**
   - Docker Desktopが起動しているか確認
   - `docker --version` でDockerが利用可能か確認
   - ポート3001が他のプロセスで使用されていないか確認

2. **ローカル環境**
   - Node.js がインストールされているか確認
   - `npm run install:all` で依存関係がインストールされているか確認
   - ポート3000, 3001が利用可能か確認

### 検索が動作しない

1. **ネットワーク接続**
   - インターネット接続を確認
   - プロキシ設定を確認
   - ファイアウォール設定を確認

2. **Scryfall API**
   - https://api.scryfall.com にアクセス可能か確認
   - APIの制限に引っかかっていないか確認

### パフォーマンスが悪い

1. **システムリソース**
   - メモリ使用量を確認（4GB以上推奨）
   - CPU使用率を確認
   - ディスク容量を確認

2. **ブラウザ設定**
   - ブラウザを最新版に更新
   - キャッシュをクリア
   - 拡張機能を無効化して確認

### データが消えた

1. **バックアップの確認**
   - Docker環境: ボリュームが削除されていないか確認
   - ローカル環境: `server/data/cubes.db` ファイルが存在するか確認

2. **復旧方法**
   - Dockerボリュームの復元
   - バックアップファイルからの復元
   - 最悪の場合は再構築が必要

### ブラウザエラー

1. **JavaScript エラー**
   - ブラウザの開発者ツールでエラーを確認
   - ブラウザキャッシュをクリア
   - 異なるブラウザで試す

2. **表示の問題**
   - ページを更新（F5）
   - ハードリロード（Ctrl+F5）
   - ブラウザのズーム設定を確認

## サポート

その他の問題やご質問は、プロジェクトのGitHubページでIssueを作成してください。

- バグ報告: 詳細な再現手順と環境情報を記載
- 機能要望: 具体的な使用例と期待する動作を説明
- 質問: 上記のFAQとトラブルシューティングを確認後に投稿

---

このマニュアルがMTGキューブ構築の助けになれば幸いです。楽しいキューブライフを！ 🎲